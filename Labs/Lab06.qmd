---
title: The Sampling Distribution
subtitle: Lab 6
author: Michael Pascale
date: 2025-10-17
---

```{r}
#| warning: false
#| message: false
#| echo: false
library(tidyverse)
theme_set(theme_classic())
set.seed(872969)
```

In this lab, students will simulate sampling from a population to demonstrate the properties of the theoretical sampling distribution.

Choosing some random variable that we could measure, we will _simulate_ the population as an exercise.

```{r}
N <- 1000000
population <- rnorm(N, 100, 10)
```

:::{.aside}
In class, we simulated a population of 19,000,000 college students. If this many datapoints causes your R code to run slowly (or crashes your computer), then please try a smaller number.
:::

```{r}
#| warning: false
#| message: false
#| echo: false
ggplot() +
geom_histogram(aes(x=population), fill='#772953', bins=300) + 
scale_x_continuous('IQ Score in the Population', limits=c(60,140)) +
labs(title='Population')
```

The random sample we draw (e.g. in a study of 100 participants) will have its own sample mean.

```{r}
n <- 100
single <- sample(population, n)

# The sample mean of a single random sample.
mean(single)
```

```{r}
#| warning: false
#| message: false
#| echo: false
ggplot() +
geom_histogram(aes(x=single), fill='#772953') + 
scale_x_continuous('IQ Score in One Sample', limits=c(60,140)) +
labs(title='A Single Sample')
```

With many random sample _means_ we can see the sampling distribution. Note how the variance in the sampling distribution is smaller than in the underlying samples and population. Here we have samples of size $n=10$.

```{r}
n <- 10
k <- N / n

# Create many samples of n=10
many10 <- sample(population, N, replace=TRUE)
many10 <- matrix(many10, n)

# The distribution of sample means for 100,000 random *samples* each of 10 observations.
smeans10 <- colMeans(many10)
```

```{r}
#| warning: false
#| message: false
#| echo: false
ggplot() +
geom_histogram(aes(x=smeans10), fill='#772953', bins=300) + 
scale_x_continuous('Means of Samples of Size 10', limits=c(60,140)) +
labs(title='Sampling Distribution')
```

With bigger samples of $n=100$ the variance of the sampling distribution is reduced further.

```{r}
n <- 100
k <- N / n

# Create many samples of n=100
many100 <- sample(population, N, replace=TRUE)
many100 <- matrix(many100, n)

# The distribution of sample means for 10,000 samples, of n=100 units each.
smeans100 <- colMeans(many100)
```

```{r}
#| warning: false
#| message: false
#| echo: false
ggplot() +
geom_histogram(aes(x=smeans100), fill='#772953', bins=300) + 
scale_x_continuous('Means Samples of Size 100', limits=c(60,140)) +
labs(title='Sampling Distribution')
```

This reduced variance turns out to be proportional to the square root of the sample size. It is from this property that we calculate the standard error of the mean: the standard deviation of the sampling distribution.

$$
SEM = {s \over \sqrt n} = {{ \sqrt{\sum(x_i - \bar x)^2 \over n -1}} \over \sqrt n}
$$

We'll calculate the SEM by the formula using the mean of our individual sample. 

```{r}
# Using the sample standard deviation
sem <- sd(single) / sqrt(n)
sem
```

This should approximate the standard deviation of the sampling distribution.
```{r}
# Of the sampling distribution (in practice we can't see this)
# Remember that SEM is the "Standard Error of the Means"
sd(smeans100)
```

We can use the SEM formula to calculate a 95% confidence interval around our sample mean.

```{r}
ci <- c(mean(single) - 1.96 * sem, mean(single) + 1.96 * sem)
ci
```

:::{.callout-tip title="Deliverables"}
Today's assignment produced many plots. Answer the following questions and upload your figures to Blackboard for lab credit today.

1. A screenshot of your entire RStudio screen for _each_ plot we created.
2. Did the true population mean (100) fall within the confidence interval calculated from your sample (`single`)?

_Note that the code for the plots has not been provided; you should be able to create the histograms on your own._

_Note that with simulated random data, each student will have slightly different results._
:::